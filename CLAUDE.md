# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Daily Summary æ˜¯ä¸€ä¸ªç”¨ Go ç¼–å†™çš„ macOS æ¡Œé¢å·¥å…·ï¼Œç”¨äºè‡ªåŠ¨åŒ–å·¥ä½œè®°å½•å’Œ AI æ€»ç»“ç”Ÿæˆï¼š

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- **å®šæ—¶æé†’**ï¼šæ¯å°æ—¶ï¼ˆæˆ–è‡ªå®šä¹‰åˆ†é’Ÿé—´éš”ï¼‰å¼¹çª—æé†’ç”¨æˆ·è®°å½•å·¥ä½œå†…å®¹
- **æ‰‹åŠ¨è®°å½•**ï¼šé€šè¿‡ CLI å‘½ä»¤éšæ—¶æ·»åŠ å·¥ä½œè®°å½•
- **æ™ºèƒ½é‡ç½®**ï¼šæ‰‹åŠ¨æ·»åŠ è®°å½•åè‡ªåŠ¨é¡ºå»¶ä¸‹æ¬¡æé†’æ—¶é—´ï¼Œé¿å…é‡å¤
- **æ•°æ®æŒä¹…åŒ–**ï¼šJSON æ ¼å¼å­˜å‚¨å·¥ä½œè®°å½•ï¼ŒæŒ‰æ—¥æœŸç»„ç»‡
- **AI æ€»ç»“**ï¼šæ¯å¤©æŒ‡å®šæ—¶é—´è‡ªåŠ¨è°ƒç”¨ AI ç”Ÿæˆå‰ä¸€å¤©çš„å·¥ä½œæ€»ç»“
- **å¤š AI æ”¯æŒ**ï¼šæ”¯æŒ Codexï¼ˆé»˜è®¤ï¼‰ã€Coco å’Œ Claude Code ä¸‰ç§ AI æä¾›å•†
- **åå°æœåŠ¡**ï¼šä½¿ç”¨ launchd æŒç»­è¿è¡Œï¼Œç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨
- **è¿›ç¨‹ç®¡ç†**ï¼šé€šè¿‡æ–‡ä»¶é”é˜²æ­¢é‡å¤å¯åŠ¨

**æŠ€æœ¯æ ˆï¼š**
- Go 1.19+ å¼€å‘
- ç¼–è¯‘ä¸ºå•ä¸€äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶
- macOS osascript å®ç°åŸç”Ÿå¯¹è¯æ¡†
- ç»Ÿä¸€ä»»åŠ¡è°ƒåº¦å™¨ + æ–‡ä»¶æŒä¹…åŒ–æ³¨å†Œè¡¨
- å®šæ—¶ä»»åŠ¡è°ƒåº¦ï¼ˆæ”¯æŒå°æ—¶/åˆ†é’Ÿçº§ï¼Œä»¥åŠæ¯æ—¥/æ¯å‘¨å®šæ—¶ï¼‰
- Markdown æ¨¡æ¿é©±åŠ¨çš„ Prompt ç³»ç»Ÿ
- å¤š AI æä¾›å•†æ¶æ„ï¼ˆCodex/Coco/Claude Codeï¼‰

## Development Guide

### Building

```bash
# ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶
go build -o daily_summary

# äº¤å‰ç¼–è¯‘ï¼ˆå¦‚éœ€è¦ï¼‰
GOOS=darwin GOARCH=amd64 go build -o daily_summary
GOOS=darwin GOARCH=arm64 go build -o daily_summary
```

### Testing

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test ./...

# è¿è¡Œç‰¹å®šåŒ…çš„æµ‹è¯•
go test ./internal/scheduler/

# è¿è¡Œç‰¹å®šæµ‹è¯•å‡½æ•°
go test -run TestFunctionName ./internal/scheduler/

# æ˜¾ç¤ºè¯¦ç»†è¾“å‡º
go test -v ./...

# æµ‹è¯•è¦†ç›–ç‡
go test -cover ./...
go test -coverprofile=coverage.out ./...
go tool cover -html=coverage.out
```

### ä¾èµ–ç®¡ç†

```bash
# ä¸‹è½½ä¾èµ–
go mod download

# æ¸…ç†æœªä½¿ç”¨çš„ä¾èµ–
go mod tidy

# æŸ¥çœ‹ä¾èµ–å›¾
go mod graph

# æ›´æ–°ä¾èµ–
go get -u ./...
```

### å¿«é€Ÿæµ‹è¯•è„šæœ¬

é¡¹ç›®æä¾›äº†å¤šä¸ªæµ‹è¯•è„šæœ¬æ–¹ä¾¿å¼€å‘ï¼š

```bash
# å¿«é€ŸåŠŸèƒ½æµ‹è¯•ï¼ˆåˆ†é’Ÿçº§è°ƒåº¦ï¼‰
./scripts/quick_test.sh

# æµ‹è¯•é…ç½®åŠ è½½
./scripts/test_config.sh

# æµ‹è¯•å¯¹è¯æ¡†
./scripts/test_dialog.sh

# æµ‹è¯•åˆ†é’Ÿçº§è°ƒåº¦
./scripts/test_minute_interval.sh
```

### å¼€å‘è°ƒè¯•

**æœ¬åœ°è¿è¡Œ**ï¼š
```bash
# ç›´æ¥è¿è¡Œï¼ˆä½¿ç”¨é»˜è®¤é…ç½®ï¼‰
go run main.go

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®
go run main.go --config ./config.yaml

# æµ‹è¯•ç‰¹å®šå‘½ä»¤
go run main.go add "æµ‹è¯•è®°å½•"
go run main.go popup
go run main.go list
go run main.go summary --date 2026-01-20
go run main.go weekly --date 2026-01-20
```

**æŸ¥çœ‹æ—¥å¿—**ï¼š
```bash
# å®æ—¶æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f ./run/logs/app.log

# æŸ¥çœ‹è°ƒåº¦å™¨æ£€æŸ¥æ—¥å¿—
tail -f ./run/logs/scheduler_check.log

# æŸ¥çœ‹ launchd è¾“å‡º
tail -f ./run/logs/stdout.log
tail -f ./run/logs/stderr.log
```

**è°ƒè¯•ä»»åŠ¡ç³»ç»Ÿ**ï¼š
```bash
# æŸ¥çœ‹ä»»åŠ¡æ³¨å†Œè¡¨
cat run/tasks.json | jq '.'

# æŸ¥çœ‹ç‰¹å®šä»»åŠ¡çŠ¶æ€
cat run/tasks.json | jq '.tasks[] | select(.id=="work-reminder")'

# é‡ç½®ä»»åŠ¡æ³¨å†Œè¡¨ï¼ˆé‡æ–°åˆå§‹åŒ–ï¼‰
rm run/tasks.json
go run main.go serve  # ä¼šè‡ªåŠ¨åˆ›å»ºæ–°çš„ tasks.json
```

**è°ƒè¯• launchd æœåŠ¡**ï¼š
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
launchctl list | grep daily_summary

# æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
launchctl list com.humg.daily_summary

# åœæ­¢æœåŠ¡
launchctl unload ~/Library/LaunchAgents/com.humg.daily_summary.plist

# å¯åŠ¨æœåŠ¡
launchctl load ~/Library/LaunchAgents/com.humg.daily_summary.plist

# é‡å¯æœåŠ¡
launchctl unload ~/Library/LaunchAgents/com.humg.daily_summary.plist && \
launchctl load ~/Library/LaunchAgents/com.humg.daily_summary.plist
```

### ä»£ç è§„èŒƒ

**æ¥å£è®¾è®¡**ï¼š
- ä¼˜å…ˆå®šä¹‰æ¥å£ï¼Œä¾¿äºæµ‹è¯•å’Œæ‰©å±•
- æ¥å£å‘½åä½¿ç”¨åŠ¨è¯æˆ–èƒ½åŠ›æè¿°ï¼ˆå¦‚ `Dialog`, `Storage`, `AIClient`ï¼‰
- ä¿æŒæ¥å£ç²¾ç®€ï¼Œå•ä¸€èŒè´£

**é”™è¯¯å¤„ç†**ï¼š
- ä½¿ç”¨ `fmt.Errorf` åŒ…è£…é”™è¯¯ï¼Œæ·»åŠ ä¸Šä¸‹æ–‡ä¿¡æ¯
- æ—¥å¿—è®°å½•é”™è¯¯è¯¦æƒ…ï¼Œè¿”å›ç»™è°ƒç”¨è€…ç®€æ´çš„é”™è¯¯ä¿¡æ¯
- åŒºåˆ†è‡´å‘½é”™è¯¯å’Œéè‡´å‘½é”™è¯¯

**æ—¥å¿—è§„èŒƒ**ï¼š
- ä½¿ç”¨ `log.Printf` è®°å½•é‡è¦æ“ä½œå’ŒçŠ¶æ€
- é”™è¯¯æ—¥å¿—åŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯
- é¿å…åœ¨å¾ªç¯ä¸­å¤§é‡æ‰“å°æ—¥å¿—

**é…ç½®ä¼˜å…ˆçº§**ï¼š
1. å‘½ä»¤è¡Œå‚æ•°
2. é…ç½®æ–‡ä»¶
3. é»˜è®¤å€¼

### æ·»åŠ æ–° AI æä¾›å•†

å¦‚éœ€æ·»åŠ æ–°çš„ AI æä¾›å•†æ”¯æŒï¼š

1. åœ¨ `internal/summary/` åˆ›å»ºæ–°çš„å®¢æˆ·ç«¯æ–‡ä»¶ï¼ˆå¦‚ `openai.go`ï¼‰
2. å®ç° `AIClient` æ¥å£ï¼š
   ```go
   type NewAIClient struct {
       // é…ç½®å­—æ®µ
   }

   func (c *NewAIClient) GenerateSummary(prompt string) (string, error) {
       // å®ç°æ€»ç»“ç”Ÿæˆé€»è¾‘
   }
   ```
3. åœ¨ `main.go` ä¸­æ·»åŠ æ–°æä¾›å•†çš„åˆå§‹åŒ–é€»è¾‘
4. æ›´æ–° `models.Config` æ·»åŠ ç›¸å…³é…ç½®å­—æ®µ
5. æ›´æ–° `config.example.yaml` å’Œæ–‡æ¡£

### å¹³å°æ‰©å±•

å½“å‰ä»…æ”¯æŒ macOSï¼Œå¦‚éœ€æ‰©å±•åˆ°å…¶ä»–å¹³å°ï¼š

**Linux æ”¯æŒ**ï¼š
- å¯¹è¯æ¡†ï¼šä½¿ç”¨ `zenity` æˆ– `kdialog`
- é€šçŸ¥ï¼šä½¿ç”¨ `notify-send`
- åœ¨ `internal/dialog/` æ·»åŠ  Linux å®ç°

**Windows æ”¯æŒ**ï¼š
- å¯¹è¯æ¡†ï¼šä½¿ç”¨ PowerShell æˆ– WinForms
- é€šçŸ¥ï¼šä½¿ç”¨ Windows Toast
- åœ¨ `internal/dialog/` æ·»åŠ  Windows å®ç°

**è·¨å¹³å°æŠ½è±¡**ï¼š
- ä¿æŒ `Dialog` æ¥å£ä¸å˜
- ä½¿ç”¨æ„å»ºæ ‡ç­¾ï¼ˆbuild tagsï¼‰åŒºåˆ†å¹³å°å®ç°
- ç¼–è¯‘æ—¶è‡ªåŠ¨é€‰æ‹©å¯¹åº”å¹³å°çš„å®ç°

## Troubleshooting

### å¸¸è§é—®é¢˜

**1. æœåŠ¡æ— æ³•å¯åŠ¨**

æ£€æŸ¥é¡¹ï¼š
- æ˜¯å¦å·²æœ‰å®ä¾‹åœ¨è¿è¡Œï¼š`launchctl list | grep daily_summary`
- æŸ¥çœ‹è¿›ç¨‹é”æ–‡ä»¶ï¼š`cat run/daily_summary.lock`
- æ£€æŸ¥æ—¥å¿—ï¼š`tail -f run/logs/stderr.log`

è§£å†³æ–¹æ¡ˆï¼š
```bash
# å¼ºåˆ¶åœæ­¢æ—§å®ä¾‹
launchctl unload ~/Library/LaunchAgents/com.humg.daily_summary.plist
rm run/daily_summary.lock

# é‡æ–°å¯åŠ¨
./scripts/install.sh
```

**2. å¯¹è¯æ¡†ä¸å¼¹å‡º**

æ£€æŸ¥é¡¹ï¼š
- æœåŠ¡æ˜¯å¦è¿è¡Œï¼š`ps aux | grep daily_summary`
- æŸ¥çœ‹ä¸‹æ¬¡æé†’æ—¶é—´ï¼š`tail -20 run/logs/app.log | grep "Next reminder"`
- ç¡®è®¤æ—¶é—´å¯¹é½æ˜¯å¦æ­£ç¡®

è°ƒè¯•ï¼š
```bash
# æ‰‹åŠ¨è§¦å‘å¯¹è¯æ¡†æµ‹è¯•
./scripts/test_dialog.sh

# ä½¿ç”¨åˆ†é’Ÿçº§è°ƒåº¦å¿«é€Ÿæµ‹è¯•
cp config.pomodoro.yaml config.yaml
./scripts/quick_test.sh
```

**3. æ€»ç»“ç”Ÿæˆå¤±è´¥**

æ£€æŸ¥é¡¹ï¼š
- AI CLI æ˜¯å¦å®‰è£…ï¼š`which codex`ã€`which coco` æˆ– `which claude-code`
- æ˜¯å¦æœ‰å·¥ä½œè®°å½•ï¼š`daily_summary list`
- é…ç½®æ˜¯å¦æ­£ç¡®ï¼š`cat config.yaml`
- Prompt æ¨¡æ¿æ˜¯å¦å­˜åœ¨ï¼š`ls templates/`
- ä»»åŠ¡çŠ¶æ€æ˜¯å¦æ­£å¸¸ï¼š`cat run/tasks.json`

è§£å†³æ–¹æ¡ˆï¼š
```bash
# æ‰‹åŠ¨æµ‹è¯•æ€»ç»“ç”Ÿæˆ
daily_summary summary --date 2026-01-20

# æ£€æŸ¥ä»»åŠ¡é”™è¯¯ä¿¡æ¯
cat run/tasks.json | grep -A 5 "daily-summary"

# ä½¿ç”¨å›é€€æœºåˆ¶ï¼ˆå³ä½¿ AI ä¸å¯ç”¨ä¹Ÿèƒ½ç”Ÿæˆç®€å•æ€»ç»“ï¼‰
# ç¨‹åºä¼šè‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨å›é€€æœºåˆ¶
```

**4. æ—¶é—´å¯¹é½é—®é¢˜**

ç°è±¡ï¼šæé†’æ—¶é—´ä¸åœ¨æ•´ç‚¹æˆ–é¢„æœŸçš„åˆ†é’Ÿè¾¹ç•Œ

åŸå› ï¼š
- æœåŠ¡å¯åŠ¨æ—¶é—´ä¸åœ¨è¾¹ç•Œä¸Š
- ç³»ç»Ÿæ—¶é—´è·³å˜ï¼ˆNTP åŒæ­¥ã€æ‰‹åŠ¨è°ƒæ•´ï¼‰

è§£å†³æ–¹æ¡ˆï¼š
```bash
# é‡å¯æœåŠ¡ï¼Œé‡æ–°å¯¹é½
launchctl unload ~/Library/LaunchAgents/com.humg.daily_summary.plist
launchctl load ~/Library/LaunchAgents/com.humg.daily_summary.plist

# æŸ¥çœ‹æ—¥å¿—ç¡®è®¤å¯¹é½
tail -f run/logs/app.log
```

**5. æ—¥å¿—æ–‡ä»¶è¿‡å¤§**

é…ç½® `max_log_size_mb` å¯ç”¨æ—¥å¿—è½®è½¬ï¼š

```yaml
enable_logging: true
max_log_size_mb: 10  # è¶…è¿‡ 10MB è‡ªåŠ¨è½®è½¬
```

æ‰‹åŠ¨æ¸…ç†ï¼š
```bash
# åˆ é™¤æ—§æ—¥å¿—
rm run/logs/app.log.old

# æ¸…ç©ºå½“å‰æ—¥å¿—
: > run/logs/app.log
```

**6. ä»»åŠ¡è°ƒåº¦ä¸æ­£å¸¸**

ç°è±¡ï¼šæŸä¸ªä»»åŠ¡é•¿æ—¶é—´æœªæ‰§è¡Œæˆ–æ‰§è¡Œæ—¶é—´ä¸ç¬¦åˆé¢„æœŸ

æ£€æŸ¥é¡¹ï¼š
- æŸ¥çœ‹ä»»åŠ¡æ³¨å†Œè¡¨ï¼š`cat run/tasks.json`
- æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å¯ç”¨ï¼š`enabled: true`
- æŸ¥çœ‹ NextRun æ—¶é—´æ˜¯å¦åˆç†
- æŸ¥çœ‹ LastError æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

è§£å†³æ–¹æ¡ˆï¼š
```bash
# æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€
cat run/tasks.json | jq '.tasks[] | {id, enabled, next_run, last_error}'

# æ‰‹åŠ¨è§¦å‘ä»»åŠ¡æµ‹è¯•
daily_summary popup      # æµ‹è¯•æé†’ä»»åŠ¡
daily_summary summary    # æµ‹è¯•æ€»ç»“ä»»åŠ¡
daily_summary weekly     # æµ‹è¯•å‘¨æ€»ç»“ä»»åŠ¡

# å¦‚æœä»»åŠ¡çŠ¶æ€å¼‚å¸¸ï¼Œåˆ é™¤ tasks.json å¹¶é‡å¯
mv run/tasks.json run/tasks.json.backup
./scripts/install.sh

# æŸ¥çœ‹è°ƒåº¦å™¨æ£€æŸ¥æ—¥å¿—
tail -f run/logs/scheduler_check.log
```

### é‡è¦æ³¨æ„äº‹é¡¹
- å¯¹è¯è¿‡ç¨‹ä¸­ï¼Œå¦‚æœè¦å†™æ–°æ–‡æ¡£ï¼Œå¿…é¡»å¾—åˆ°æˆ‘çš„æ‰¹å‡†
- å·¥ä½œè¿‡ç¨‹äº§å‡ºçš„æ–‡æ¡£ï¼Œç»Ÿä¸€æ”¾åœ¨ docs/ ç›®å½•ä¸‹

**1. é…ç½®æ–‡ä»¶è·¯å¾„**

ä¼˜å…ˆçº§é¡ºåºï¼š
1. `--config` å‚æ•°æŒ‡å®šçš„è·¯å¾„
2. é¡¹ç›®æ ¹ç›®å½•ï¼ˆwork_dirï¼‰çš„ `config.yaml`
3. `~/.config/daily_summary/config.yaml`ï¼ˆå¤‡é€‰ï¼‰
4. é»˜è®¤é…ç½®ï¼ˆç¡¬ç¼–ç ï¼‰

**2. å·¥ä½œç›®å½•**

launchd æœåŠ¡çš„å·¥ä½œç›®å½•ç”± plist ä¸­çš„ `WorkingDirectory` æŒ‡å®šï¼Œå¿…é¡»æ˜¯é¡¹ç›®æ ¹ç›®å½•çš„ç»å¯¹è·¯å¾„ã€‚

ç›¸å¯¹è·¯å¾„ï¼ˆå¦‚ `./run/data`ï¼‰ä¼šåŸºäºè¿™ä¸ªç›®å½•è§£æã€‚

**3. æ—¶åŒºå¤„ç†**

æ‰€æœ‰æ—¶é—´éƒ½ä½¿ç”¨ç³»ç»Ÿæœ¬åœ°æ—¶åŒºï¼Œæ— æ—¶åŒºè½¬æ¢é€»è¾‘ã€‚

**4. å¹¶å‘å®‰å…¨**

- Storage æ“ä½œæ˜¯æ–‡ä»¶çº§çš„ï¼Œæ— é”ä¿æŠ¤
- åŒä¸€æ—¶é—´åªåº”æœ‰ä¸€ä¸ªæœåŠ¡å®ä¾‹è¿è¡Œï¼ˆé€šè¿‡è¿›ç¨‹é”ä¿è¯ï¼‰
- æ‰‹åŠ¨å‘½ä»¤ï¼ˆadd/list/summaryï¼‰ä¸æœåŠ¡å®ä¾‹å¯èƒ½æœ‰ç«æ€ï¼Œä½†å½±å“å¾ˆå°

**5. æ•°æ®æŒä¹…åŒ–**

- JSON æ–‡ä»¶æŒ‰æ—¥æœŸåˆ†æ–‡ä»¶ï¼Œæ˜“äºå¤‡ä»½å’Œè¿ç§»
- æ²¡æœ‰æ•°æ®åº“ï¼Œæ²¡æœ‰äº‹åŠ¡ä¿è¯
- æ–‡ä»¶å†™å…¥å¤±è´¥ä¼šä¸¢å¤±æ•°æ®ï¼ˆç½•è§ï¼‰

**6. AI è°ƒç”¨**

- AI è°ƒç”¨æ˜¯åŒæ­¥é˜»å¡çš„ï¼Œç”Ÿæˆæ€»ç»“æœŸé—´è°ƒåº¦å™¨ä¼šç­‰å¾…
- å¦‚æœ AI å“åº”è¶…æ—¶æˆ–å¤±è´¥ï¼Œä½¿ç”¨å›é€€æ€»ç»“
- AI è°ƒç”¨å¤±è´¥ä¸ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ

**7. macOS æƒé™**

é¦–æ¬¡è¿è¡Œæ—¶ macOS å¯èƒ½ä¼šè¯·æ±‚ä»¥ä¸‹æƒé™ï¼š
- è¾…åŠ©åŠŸèƒ½æƒé™ï¼ˆosascript å¯¹è¯æ¡†ï¼‰
- é€šçŸ¥æƒé™ï¼ˆç³»ç»Ÿé€šçŸ¥ï¼‰

å¦‚æœå¯¹è¯æ¡†æ— æ³•æ˜¾ç¤ºï¼Œæ£€æŸ¥"ç³»ç»Ÿåå¥½è®¾ç½® > å®‰å…¨æ€§ä¸éšç§ > éšç§ > è¾…åŠ©åŠŸèƒ½"ã€‚

## Best Practices

### é…ç½®å»ºè®®

**ç”Ÿäº§ç¯å¢ƒ**ï¼š
```yaml
hourly_interval: 1                # æ¯å°æ—¶è®°å½•ä¸€æ¬¡
summary_time: "23:00"             # æ™šä¸Š 11 ç‚¹ç”Ÿæˆæ€»ç»“
ai_provider: "codex"              # ä½¿ç”¨ Codex
enable_logging: true
max_log_size_mb: 10               # é™åˆ¶æ—¥å¿—å¤§å°
enable_weekly_summary: true       # å¯ç”¨å‘¨æ€»ç»“
weekly_summary_time: "11:00"      # å‘¨ä¸€ 11 ç‚¹ç”Ÿæˆå‘¨æ€»ç»“
weekly_summary_day: 1
```

**å¼€å‘/æµ‹è¯•**ï¼š
```yaml
minute_interval: 5                # æ¯ 5 åˆ†é’Ÿæµ‹è¯•ä¸€æ¬¡
summary_time: "00:00"
ai_provider: "codex"
enable_logging: true
enable_weekly_summary: false      # æµ‹è¯•æ—¶ç¦ç”¨å‘¨æ€»ç»“
```

**ç•ªèŒ„å·¥ä½œæ³•**ï¼š
```yaml
minute_interval: 25               # æ¯ 25 åˆ†é’Ÿè®°å½•
summary_time: "18:00"             # ä¸‹ç­æ—¶ç”Ÿæˆæ€»ç»“
ai_provider: "coco"               # å¯é€‰ä½¿ç”¨ Coco
enable_weekly_summary: true
weekly_summary_time: "18:00"      # å‘¨äº”ä¸‹ç­æ—¶ç”Ÿæˆå‘¨æ€»ç»“
weekly_summary_day: 5
```

### å¤‡ä»½å»ºè®®

é‡è¦æ•°æ®ï¼š
- `run/data/*.json` - æ‰€æœ‰å·¥ä½œè®°å½•
- `run/summaries/daily/*.md` - æ¯æ—¥æ€»ç»“æ–‡ä»¶
- `run/summaries/weekly/*.md` - æ¯å‘¨æ€»ç»“æ–‡ä»¶
- `run/tasks.json` - ä»»åŠ¡æ³¨å†Œè¡¨çŠ¶æ€
- `config.yaml` - é…ç½®æ–‡ä»¶
- `templates/*.md` - Prompt æ¨¡æ¿ï¼ˆå¦‚æœ‰è‡ªå®šä¹‰ï¼‰

å¤‡ä»½è„šæœ¬ç¤ºä¾‹ï¼š
```bash
#!/bin/bash
tar -czf backup-$(date +%Y%m%d).tar.gz run/data run/summaries run/tasks.json config.yaml templates/
```

### ç›‘æ§å»ºè®®

ç›‘æ§é¡¹ï¼š
- è¿›ç¨‹æ˜¯å¦è¿è¡Œï¼š`launchctl list | grep daily_summary`
- æ—¥å¿—æ–‡ä»¶å¤§å°ï¼š`du -sh run/logs/`
- ç£ç›˜ç©ºé—´ï¼š`df -h .`
- æœ€è¿‘ä¸€æ¬¡æé†’æ—¶é—´ï¼š`tail run/logs/app.log | grep "Work entry saved"`

å¯ä»¥ä½¿ç”¨ cron æˆ–å…¶ä»–ç›‘æ§å·¥å…·å®šæœŸæ£€æŸ¥ã€‚

## Key Features

### 1. æ™ºèƒ½å®šæ—¶å™¨é‡ç½®æœºåˆ¶

**é—®é¢˜**ï¼šç”¨æˆ·æ‰‹åŠ¨æ·»åŠ è®°å½•åï¼Œå¦‚æœä¸‹æ¬¡å®šæ—¶æé†’åœ¨ä¸ä¹…åè§¦å‘ï¼Œä¼šå¯¼è‡´é‡å¤æé†’ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç”¨æˆ·æ‰§è¡Œ `add` å‘½ä»¤æ—¶ï¼ŒCLI ç›´æ¥è°ƒç”¨ `UpdateTaskSchedule()` æ›´æ–°ä»»åŠ¡æ³¨å†Œè¡¨
- é‡æ–°è®¡ç®—ä¸‹ä¸€æ¬¡æé†’æ—¶é—´ï¼ˆä»å½“å‰æ—¶é—´é¡ºå»¶ä¸€ä¸ªå®Œæ•´å‘¨æœŸï¼‰
- æ›´æ–°æŒä¹…åŒ–åˆ° `run/tasks.json` æ–‡ä»¶
- Scheduler æ¯åˆ†é’Ÿæ£€æŸ¥æ—¶ä¼šè¯»å–æœ€æ–°çš„è°ƒåº¦æ—¶é—´

**ç¤ºä¾‹**ï¼š
```
10:00 - æœåŠ¡å¯åŠ¨ï¼Œä¸‹æ¬¡æé†’: 11:00
10:30 - ç”¨æˆ·æ‰§è¡Œ add æ·»åŠ è®°å½•
10:30 - ç›´æ¥æ›´æ–°ä»»åŠ¡æ³¨å†Œè¡¨ï¼Œä¸‹æ¬¡æé†’: 11:30ï¼ˆé¿å… 11:00 é‡å¤æé†’ï¼‰
11:30 - Scheduler è¯»å–æ³¨å†Œè¡¨ï¼Œè§¦å‘æé†’
```

### 2. è¿›ç¨‹é”æœºåˆ¶

**ç›®çš„**ï¼šé˜²æ­¢åŒæ—¶è¿è¡Œå¤šä¸ª daily_summary å®ä¾‹ã€‚

**å®ç°**ï¼š
- å¯åŠ¨æ—¶æ£€æŸ¥ `run/daily_summary.lock` æ–‡ä»¶
- å¦‚æœå­˜åœ¨ä¸” PID è¿›ç¨‹ä»åœ¨è¿è¡Œï¼Œæ‹’ç»å¯åŠ¨å¹¶æç¤º
- å¦‚æœè¿›ç¨‹å·²ç»“æŸï¼Œæ¸…ç†æ—§é”æ–‡ä»¶å¹¶åˆ›å»ºæ–°é”
- é€€å‡ºæ—¶è‡ªåŠ¨é‡Šæ”¾é”æ–‡ä»¶

### 3. At-least-once æ€»ç»“ç”Ÿæˆ

**ä¿è¯**ï¼šå³ä½¿é”™è¿‡äº†é…ç½®çš„æ€»ç»“æ—¶é—´ï¼Œä¹Ÿä¼šè¡¥å……ç”Ÿæˆã€‚

**æœºåˆ¶**ï¼š
- `DailyData` åŒ…å« `summary_generated` å­—æ®µè·Ÿè¸ªçŠ¶æ€
- Scheduler å¯åŠ¨æ—¶æ£€æŸ¥æ˜¨å¤©æ˜¯å¦å·²ç”Ÿæˆæ€»ç»“
- å¦‚æœæœªç”Ÿæˆä¸”å·²è¿‡é…ç½®æ—¶é—´ï¼Œç«‹å³ç”Ÿæˆ
- ä¹‹åç»§ç»­æ­£å¸¸è°ƒåº¦ä¸‹ä¸€æ¬¡ç”Ÿæˆ

### 4. å»¶è¿Ÿæ£€æµ‹ä¸è·³è¿‡

**é—®é¢˜**ï¼šç”µè„‘ä¼‘çœ åå”¤é†’ï¼Œtimer è§¦å‘æ—¶é—´ä¼šä¸¥é‡å»¶è¿Ÿã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å®šæ—¶å™¨è§¦å‘æ—¶ï¼Œæ¯”è¾ƒå®é™…æ—¶é—´å’Œé¢„æœŸæ—¶é—´
- å¦‚æœå»¶è¿Ÿè¶…è¿‡é˜ˆå€¼ï¼ˆå°æ—¶çº§ 5 åˆ†é’Ÿï¼Œåˆ†é’Ÿçº§ 50%ï¼‰ï¼Œè·³è¿‡æœ¬æ¬¡è°ƒåº¦
- é‡æ–°è®¡ç®—ä¸‹ä¸€æ¬¡è§¦å‘æ—¶é—´

### 5. æ—¥å¿—è½®è½¬

**æœºåˆ¶**ï¼š
- LogRotateTask å®šæœŸæ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¤§å°ï¼ˆé»˜è®¤æ¯ 3 å°æ—¶ï¼‰
- æ£€æŸ¥å¤šä¸ªæ—¥å¿—æ–‡ä»¶ï¼šapp.logã€stdout.logã€stderr.logã€scheduler_check.log
- å¦‚æœè¶…è¿‡ `max_log_size_mb` é™åˆ¶ï¼Œå°†å½“å‰æ—¥å¿—é‡å‘½åä¸º `.old`
- åˆ›å»ºæ–°çš„æ—¥å¿—æ–‡ä»¶
- ä¿ç•™æœ€è¿‘ä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶ï¼ˆcurrent + .oldï¼‰
- ä»»åŠ¡çŠ¶æ€æŒä¹…åŒ–åˆ° tasks.json

### 6. ä»»åŠ¡æ³¨å†Œè¡¨æŒä¹…åŒ–

**ç›®çš„**ï¼šä¿è¯ä»»åŠ¡çŠ¶æ€åœ¨è¿›ç¨‹é‡å¯åä¸ä¸¢å¤±ã€‚

**å®ç°**ï¼š
- ä»»åŠ¡é…ç½®å’ŒçŠ¶æ€å­˜å‚¨åœ¨ `run/tasks.json`
- åŒ…å« NextRunã€LastRunã€LastSuccessã€LastError ç­‰å­—æ®µ
- æ¯æ¬¡ä»»åŠ¡æ‰§è¡Œåè‡ªåŠ¨æ›´æ–°å¹¶ä¿å­˜
- æ”¯æŒä»»åŠ¡ç‰¹å®šæ•°æ®å­˜å‚¨ï¼ˆData å­—æ®µï¼‰
- å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½å¹¶æ¢å¤ä»»åŠ¡çŠ¶æ€

**ä»»åŠ¡ç±»å‹**ï¼š
- **interval**ï¼šæŒ‰å›ºå®šé—´éš”æ‰§è¡Œï¼ˆå¦‚å·¥ä½œæé†’ã€æ—¥å¿—è½®è½¬ï¼‰
- **daily**ï¼šæ¯æ—¥æŒ‡å®šæ—¶é—´æ‰§è¡Œï¼ˆå¦‚æ¯æ—¥æ€»ç»“ï¼‰
- **once**ï¼šä¸€æ¬¡æ€§ä»»åŠ¡ï¼ˆæœªæ¥æ‰©å±•ç”¨ï¼‰

### 7. æ‰¹é‡æ€»ç»“ç”Ÿæˆ

**åœºæ™¯**ï¼šç”¨æˆ·å¯èƒ½æœ‰å¤šå¤©æœªç”Ÿæˆæ€»ç»“ï¼Œæˆ–è€…é¦–æ¬¡ä½¿ç”¨å·¥å…·ã€‚

**æœºåˆ¶**ï¼š
- SummaryTask å¯åŠ¨æ—¶æ‰«ææ‰€æœ‰æ—¥æœŸçš„å·¥ä½œè®°å½•
- è¯†åˆ«æ‰€æœ‰ `summary_generated: false` çš„æ—¥æœŸ
- æŒ‰æ—¶é—´é¡ºåºæ‰¹é‡ç”Ÿæˆæ‰€æœ‰é—æ¼çš„æ€»ç»“
- æ¯ä¸ªæ€»ç»“ç‹¬ç«‹ç”Ÿæˆå’Œä¿å­˜
- å…¨éƒ¨å®Œæˆåæ›´æ–°ä»»åŠ¡çŠ¶æ€

### 8. å‘¨æ€»ç»“èšåˆ

**åŠŸèƒ½**ï¼šè‡ªåŠ¨æ±‡æ€»ä¸€å‘¨çš„å·¥ä½œå†…å®¹ï¼Œç”Ÿæˆæ›´é«˜å±‚æ¬¡çš„æ€»ç»“ã€‚

**å®ç°**ï¼š
- WeeklySummaryTask åœ¨é…ç½®çš„æ˜ŸæœŸå‡ å’Œæ—¶é—´è§¦å‘
- è¯»å–è¯¥å‘¨æ‰€æœ‰æ¯æ—¥æ€»ç»“ï¼ˆISO å‘¨å®šä¹‰ï¼šå‘¨ä¸€åˆ°å‘¨æ—¥ï¼‰
- ä½¿ç”¨ `templates/weekly_summary_prompt.md` æ¨¡æ¿
- å°† 7 å¤©çš„æ€»ç»“ä½œä¸ºè¾“å…¥å‘é€ç»™ AI
- ç”Ÿæˆæ–‡ä»¶å‘½åä¸º `YYYY-Wnn.md`ï¼ˆISO å‘¨ç¼–å·ï¼‰
- é˜²æ­¢åŒä¸€å‘¨é‡å¤ç”Ÿæˆï¼ˆé€šè¿‡ Data å­—æ®µè·Ÿè¸ªï¼‰

### 9. Prompt æ¨¡æ¿ç³»ç»Ÿ

**ç›®çš„**ï¼šè®©ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ AI æ€»ç»“çš„æ ¼å¼å’Œé£æ ¼ã€‚

**å®ç°**ï¼š
- æ¨¡æ¿å­˜å‚¨åœ¨ `templates/` ç›®å½•
- æ”¯æŒæ¯æ—¥æ€»ç»“æ¨¡æ¿ï¼ˆ`summary_prompt.md`ï¼‰
- æ”¯æŒæ¯å‘¨æ€»ç»“æ¨¡æ¿ï¼ˆ`weekly_summary_prompt.md`ï¼‰
- æ¨¡æ¿ä¸­ä½¿ç”¨å ä½ç¬¦ï¼ˆå¦‚ `{date}`, `{formatted_entries}`ï¼‰
- åŠ è½½å¤±è´¥æ—¶ä½¿ç”¨ç¡¬ç¼–ç å›é€€æ¨¡æ¿
- ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰æ¨¡æ¿è€Œæ— éœ€ä¿®æ”¹ä»£ç 

## Architecture

### ä¸»è¦ç»„ä»¶

1. **å®šæ—¶å™¨æ¨¡å—ï¼ˆSchedulerï¼‰** - `internal/scheduler/`
   - **ç»Ÿä¸€è°ƒåº¦æ¶æ„**ï¼š
     - å•ä¸€è°ƒåº¦å™¨æ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ‰€æœ‰ä»»åŠ¡
     - ä»»åŠ¡æ³¨å†Œè¡¨ï¼ˆregistry.goï¼‰æŒä¹…åŒ–åˆ° `run/tasks.json`
     - æ”¯æŒä¸‰ç§ä»»åŠ¡ç±»å‹ï¼šintervalï¼ˆé—´éš”ï¼‰ã€dailyï¼ˆæ¯æ—¥ï¼‰ã€onceï¼ˆä¸€æ¬¡æ€§ï¼‰
   - **ä»»åŠ¡ç³»ç»Ÿ**ï¼ˆ`internal/tasks/`ï¼‰ï¼š
     - ReminderTaskï¼šå·¥ä½œè®°å½•æé†’ï¼ˆæ”¯æŒå°æ—¶çº§æˆ–åˆ†é’Ÿçº§é—´éš”ï¼‰
     - SummaryTaskï¼šæ¯æ—¥æ€»ç»“ç”Ÿæˆï¼ˆæŒ‡å®šæ—¶é—´è§¦å‘ï¼‰
     - WeeklySummaryTaskï¼šæ¯å‘¨æ€»ç»“ç”Ÿæˆï¼ˆæŒ‡å®šæ˜ŸæœŸå’Œæ—¶é—´ï¼‰
     - LogRotateTaskï¼šæ—¥å¿—è½®è½¬ï¼ˆé—´éš”è§¦å‘ï¼‰
   - **æ™ºèƒ½æ—¶é—´å¯¹é½**ï¼š
     - å°æ—¶çº§ï¼šå¯¹é½åˆ°æ•´ç‚¹ï¼ˆå¦‚ 10:00, 11:00ï¼‰
     - åˆ†é’Ÿçº§ï¼šå¯¹é½åˆ°åˆ†é’Ÿè¾¹ç•Œï¼ˆå¦‚ 10:30, 11:00ï¼‰
   - **å»¶è¿Ÿæ£€æµ‹**ï¼šæ£€æµ‹ç³»ç»Ÿå”¤é†’å¯¼è‡´çš„å»¶è¿Ÿï¼Œè·³è¿‡è¿‡æœŸçš„æé†’
   - **çŠ¶æ€æŒä¹…åŒ–**ï¼šæ¯ä¸ªä»»åŠ¡è·Ÿè¸ª NextRunã€LastRunã€LastSuccessã€LastError
   - **At-least-once è¯­ä¹‰**ï¼šå¯åŠ¨æ—¶æ£€æŸ¥æ˜¯å¦æœ‰é—æ¼çš„æ€»ç»“ï¼Œæ‰¹é‡è¡¥å……ç”Ÿæˆ

2. **å¯¹è¯æ¡†æ¨¡å—ï¼ˆDialogï¼‰** - `internal/dialog/`
   - **å¹³å°**ï¼šmacOS osascript å®ç°
   - **åŠŸèƒ½**ï¼š
     - æ˜¾ç¤ºè¾“å…¥å¯¹è¯æ¡†æ”¶é›†å·¥ä½œè®°å½•
     - æ”¯æŒè¶…æ—¶è‡ªåŠ¨å…³é—­
     - æ˜¾ç¤ºé€šçŸ¥ï¼ˆæ€»ç»“ç”Ÿæˆå®Œæˆï¼‰
   - **ä¸Šä¸‹æ–‡å±•ç¤º**ï¼šå¼¹çª—ä¸­å±•ç¤ºå½“æ—¥å·²æœ‰è®°å½•ï¼Œå¸®åŠ©ç”¨æˆ·å›å¿†

3. **æ•°æ®å­˜å‚¨æ¨¡å—ï¼ˆStorageï¼‰** - `internal/storage/`
   - **æ ¼å¼**ï¼šJSON æ–‡ä»¶å­˜å‚¨
   - **ç»„ç»‡æ–¹å¼**ï¼šæŒ‰æ—¥æœŸåˆ†æ–‡ä»¶ï¼ˆ`YYYY-MM-DD.json`ï¼‰
   - **æ•°æ®ç»“æ„**ï¼š
     - WorkEntryï¼šå•æ¡è®°å½•ï¼ˆæ—¶é—´æˆ³ + å†…å®¹ï¼‰
     - DailyDataï¼šå•æ—¥æ‰€æœ‰è®°å½• + æ€»ç»“ç”ŸæˆçŠ¶æ€
   - **å…ƒæ•°æ®è·Ÿè¸ª**ï¼šè®°å½•æ€»ç»“æ˜¯å¦å·²ç”Ÿæˆï¼Œé¿å…é‡å¤

4. **æ€»ç»“ç”Ÿæˆæ¨¡å—ï¼ˆSummary Generatorï¼‰** - `internal/summary/`
   - **å¤š AI æ¶æ„**ï¼š
     - AIClient æ¥å£æŠ½è±¡
     - CodexClient å®ç°ï¼ˆé»˜è®¤ï¼‰
     - CocoClient å®ç°
     - ClaudeClient å®ç°
   - **æ¨¡æ¿ç³»ç»Ÿ**ï¼š
     - Prompt ä» `templates/summary_prompt.md` åŠ è½½
     - æ”¯æŒæ¯æ—¥å’Œæ¯å‘¨æ€»ç»“æ¨¡æ¿
     - æ¨¡æ¿åŠ è½½å¤±è´¥æ—¶ä½¿ç”¨ç¡¬ç¼–ç å›é€€
   - **æ‰¹é‡ç”Ÿæˆ**ï¼šSummaryTask è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰æœªç”Ÿæˆçš„å†å²æ€»ç»“
   - **å›é€€æœºåˆ¶**ï¼šAI ä¸å¯ç”¨æ—¶ç”Ÿæˆç®€å•æ¨¡æ¿æ€»ç»“
   - **é€šçŸ¥é›†æˆ**ï¼šæ€»ç»“ç”Ÿæˆåå‘é€ç³»ç»Ÿé€šçŸ¥

5. **CLI å‘½ä»¤æ¨¡å—ï¼ˆCLIï¼‰** - `internal/cli/`
   - **è¿›ç¨‹ç®¡ç†**ï¼š
     - æ–‡ä»¶é”æœºåˆ¶é˜²æ­¢é‡å¤å¯åŠ¨
     - PID è·Ÿè¸ªå’Œè¿›ç¨‹æ£€æµ‹
   - **æ‰‹åŠ¨æ“ä½œ**ï¼š
     - `add`ï¼šæ‰‹åŠ¨æ·»åŠ å·¥ä½œè®°å½•
     - `popup`ï¼šæ˜¾ç¤ºè¾“å…¥å¯¹è¯æ¡†ï¼ˆCLI ç‰ˆæœ¬çš„æé†’ï¼‰
     - `list`ï¼šæŸ¥çœ‹ä»Šæ—¥è®°å½•
     - `summary`ï¼šæ‰‹åŠ¨è§¦å‘æ¯æ—¥æ€»ç»“ç”Ÿæˆ
     - `weekly`ï¼šæ‰‹åŠ¨è§¦å‘æ¯å‘¨æ€»ç»“ç”Ÿæˆ
   - **è°ƒåº¦æ›´æ–°**ï¼šæ·»åŠ è®°å½•åç›´æ¥è°ƒç”¨ `UpdateTaskSchedule()` æ›´æ–°ä»»åŠ¡æ³¨å†Œè¡¨

6. **é…ç½®ç®¡ç†æ¨¡å—ï¼ˆConfigï¼‰** - `config/`
   - æ”¯æŒ YAML/JSON æ ¼å¼è‡ªåŠ¨è¯†åˆ«
   - è·¯å¾„è§£æï¼ˆç›¸å¯¹/ç»å¯¹è·¯å¾„å¤„ç†ï¼‰
   - é»˜è®¤é…ç½® fallback
   - ç›®å½•åˆ›å»ºå’Œæƒé™ç®¡ç†

### ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿè¯¦è§£

**æ¶æ„æ¦‚è§ˆ**ï¼š
- Scheduler æ¯åˆ†é’Ÿå”¤é†’ä¸€æ¬¡ï¼Œæ£€æŸ¥æ‰€æœ‰æ³¨å†Œçš„ä»»åŠ¡
- ä»»åŠ¡é…ç½®å’ŒçŠ¶æ€æŒä¹…åŒ–åˆ° `run/tasks.json`ï¼ˆTaskRegistryï¼‰
- æ¯ä¸ªä»»åŠ¡å®ç° Task æ¥å£ï¼ˆShouldRun, Execute, OnExecutedï¼‰

**å·¥ä½œæµç¨‹**ï¼š
```
1. æœåŠ¡å¯åŠ¨
   â†“
2. åŠ è½½æˆ–åˆå§‹åŒ– tasks.json
   â†“
3. å¯åŠ¨è°ƒåº¦å¾ªç¯ï¼ˆæ¯ 1 åˆ†é’Ÿï¼‰
   â†“
4. éå†æ‰€æœ‰ä»»åŠ¡
   â†“
5. è°ƒç”¨ task.ShouldRun() æ£€æŸ¥æ˜¯å¦åº”è¯¥æ‰§è¡Œ
   â†“
6. å¦‚æœåº”è¯¥æ‰§è¡Œï¼Œè°ƒç”¨ task.Execute()
   â†“
7. è°ƒç”¨ task.OnExecuted() æ›´æ–°ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
   â†“
8. ä¿å­˜ä»»åŠ¡çŠ¶æ€åˆ° tasks.json
   â†“
9. ç­‰å¾…ä¸‹ä¸€ä¸ªæ£€æŸ¥å‘¨æœŸ
```

**ä»»åŠ¡æ¥å£**ï¼š
```go
type Task interface {
    ID() string                           // ä»»åŠ¡å”¯ä¸€æ ‡è¯†
    Name() string                         // ä»»åŠ¡æ˜¾ç¤ºåç§°
    ShouldRun(now time.Time) bool        // åˆ¤æ–­æ˜¯å¦åº”è¯¥æ‰§è¡Œ
    Execute() error                       // æ‰§è¡Œä»»åŠ¡é€»è¾‘
    OnExecuted(success bool, err error)  // æ‰§è¡Œåå›è°ƒï¼ˆæ›´æ–°çŠ¶æ€ï¼‰
}
```

**å››ç§å†…ç½®ä»»åŠ¡**ï¼š
1. **ReminderTask**ï¼ˆwork-reminderï¼‰
   - ç±»å‹ï¼šinterval
   - åŠŸèƒ½ï¼šæŒ‰é…ç½®çš„é—´éš”å¼¹å‡ºå¯¹è¯æ¡†æé†’è®°å½•å·¥ä½œ
   - å»¶è¿Ÿæ£€æµ‹ï¼šå¦‚æœå»¶è¿Ÿè¶…è¿‡é—´éš”çš„ 50%ï¼Œè·³è¿‡å¹¶é‡æ–°è°ƒåº¦
   - æ›´æ–°æœºåˆ¶ï¼š`add` å‘½ä»¤æ‰§è¡Œåä¼šè°ƒç”¨ `UpdateTaskSchedule()` é¡ºå»¶ä¸‹æ¬¡æé†’

2. **SummaryTask**ï¼ˆdaily-summaryï¼‰
   - ç±»å‹ï¼šdaily
   - åŠŸèƒ½ï¼šæ¯æ—¥æŒ‡å®šæ—¶é—´ç”Ÿæˆå·¥ä½œæ€»ç»“
   - æ‰¹é‡ç”Ÿæˆï¼šå¯åŠ¨æ—¶æ£€æŸ¥æ‰€æœ‰æœªç”Ÿæˆçš„æ—¥æœŸï¼Œæ‰¹é‡è¡¥å……
   - æ¨¡æ¿é©±åŠ¨ï¼šä» `templates/summary_prompt.md` åŠ è½½ Prompt

3. **WeeklySummaryTask**ï¼ˆweekly-summaryï¼‰
   - ç±»å‹ï¼šdailyï¼ˆå®é™…æŒ‰å‘¨æ‰§è¡Œï¼Œä½†ä½¿ç”¨ daily ç±»å‹ï¼‰
   - åŠŸèƒ½ï¼šæ¯å‘¨æŒ‡å®šæ—¶é—´èšåˆç”Ÿæˆå‘¨æ€»ç»“
   - å»é‡æœºåˆ¶ï¼šé€šè¿‡ Data å­—æ®µè·Ÿè¸ª `last_generated_week`ï¼Œé˜²æ­¢é‡å¤ç”Ÿæˆ
   - ä¾èµ–æ¯æ—¥æ€»ç»“ï¼šè¯»å–è¯¥å‘¨çš„æ‰€æœ‰ daily/*.md æ–‡ä»¶ä½œä¸ºè¾“å…¥

4. **LogRotateTask**ï¼ˆlog-rotateï¼‰
   - ç±»å‹ï¼šinterval
   - åŠŸèƒ½ï¼šå®šæœŸæ£€æŸ¥å¹¶è½®è½¬æ—¥å¿—æ–‡ä»¶
   - æ£€æŸ¥å¤šä¸ªæ–‡ä»¶ï¼šapp.logã€stdout.logã€stderr.logã€scheduler_check.log
   - è½®è½¬ç­–ç•¥ï¼šè¶…è¿‡ max_log_size_mb æ—¶é‡å‘½åä¸º .oldï¼Œä¿ç•™æœ€è¿‘ä¸¤ä¸ªç‰ˆæœ¬

**ä»»åŠ¡æ³¨å†Œè¡¨ç»“æ„**ï¼ˆtasks.jsonï¼‰ï¼š
```json
{
  "tasks": [
    {
      "id": "work-reminder",
      "name": "Work Entry Reminder",
      "type": "interval",
      "enabled": true,
      "interval_minutes": 45,
      "next_run": "2026-02-02T15:00:00+08:00",
      "last_run": "2026-02-02T14:15:00+08:00",
      "last_success": "2026-02-02T14:15:00+08:00",
      "last_error": "",
      "data": {}
    },
    {
      "id": "daily-summary",
      "name": "Daily Summary Generator",
      "type": "daily",
      "enabled": true,
      "time": "11:00",
      "next_run": "2026-02-03T11:00:00+08:00",
      "last_run": "2026-02-02T11:00:00+08:00",
      "last_success": "2026-02-02T11:00:00+08:00",
      "last_error": "",
      "data": {}
    },
    {
      "id": "weekly-summary",
      "name": "Weekly Summary Generator",
      "type": "daily",
      "enabled": true,
      "time": "11:00",
      "next_run": "2026-02-03T11:00:00+08:00",
      "data": {
        "day_of_week": 1,
        "last_generated_week": "2026-05"
      }
    },
    {
      "id": "log-rotate",
      "name": "Log File Rotator",
      "type": "interval",
      "enabled": true,
      "interval_minutes": 180,
      "next_run": "2026-02-02T17:00:00+08:00",
      "data": {}
    }
  ]
}
```

### AI æ€»ç»“é›†æˆ

ç¨‹åºæ”¯æŒä¸‰ç§ AI æä¾›å•†ç”Ÿæˆå·¥ä½œæ€»ç»“ï¼š

#### 1. Codexï¼ˆé»˜è®¤æä¾›å•†ï¼‰
- **è°ƒç”¨æ–¹å¼**ï¼š`codex exec "{prompt}"`
- **å·¥ä½œç›®å½•**ï¼šåœ¨é¡¹ç›®ç›®å½•ï¼ˆwork_dirï¼‰ä¸­æ‰§è¡Œ
- **å›é€€æœºåˆ¶**ï¼šå¦‚æœ Codex ä¸å¯ç”¨ï¼Œç”Ÿæˆç®€å•æ¨¡æ¿æ€»ç»“
- **é…ç½®é¡¹**ï¼š`ai_provider: "codex"`, `codex_path: "codex"`

#### 2. Coco
- **è°ƒç”¨æ–¹å¼**ï¼š`coco -p "{prompt}"`
- **å·¥ä½œç›®å½•**ï¼šåœ¨é¡¹ç›®ç›®å½•ï¼ˆwork_dirï¼‰ä¸­æ‰§è¡Œ
- **å›é€€æœºåˆ¶**ï¼šå¦‚æœ Coco ä¸å¯ç”¨ï¼Œç”Ÿæˆç®€å•æ¨¡æ¿æ€»ç»“
- **é…ç½®é¡¹**ï¼š`ai_provider: "coco"`, `coco_path: "coco"`

#### 3. Claude Code
- **è°ƒç”¨æ–¹å¼**ï¼š`claude-code --prompt "{prompt}"`
- **å·¥ä½œç›®å½•**ï¼šä¸´æ—¶ç›®å½• `~/.daily_summary_temp`
- **å›é€€æœºåˆ¶**ï¼šå¦‚æœ Claude Code ä¸å¯ç”¨ï¼Œç”Ÿæˆç®€å•æ¨¡æ¿æ€»ç»“
- **é…ç½®é¡¹**ï¼š`ai_provider: "claude"`, `claude_code_path: "claude-code"`

#### æ€»ç»“ç”Ÿæˆæµç¨‹

å½“è§¦å‘æ€»ç»“ç”Ÿæˆæ—¶ï¼ˆæ¯æ—¥æŒ‡å®šæ—¶é—´æˆ–æ‰‹åŠ¨å‘½ä»¤ï¼‰ï¼Œç¨‹åºä¼šï¼š

1. **æŸ¥æ‰¾æœªç”Ÿæˆçš„æ€»ç»“**ï¼šSummaryTask æ£€æŸ¥æ‰€æœ‰æœªç”Ÿæˆæ€»ç»“çš„æ—¥æœŸï¼ˆæ‰¹é‡è¡¥å……ï¼‰
2. **æ”¶é›†æ•°æ®**ï¼šè¯»å–æŒ‡å®šæ—¥æœŸçš„æ‰€æœ‰å·¥ä½œè®°å½•
3. **æ£€æŸ¥è®°å½•**ï¼šå¦‚æœæ²¡æœ‰è®°å½•ï¼Œè·³è¿‡ç”Ÿæˆ
4. **åŠ è½½æ¨¡æ¿**ï¼šä» `templates/summary_prompt.md` åŠ è½½ Prompt æ¨¡æ¿ï¼ˆå¤±è´¥åˆ™ä½¿ç”¨ç¡¬ç¼–ç å›é€€ï¼‰
5. **æ„å»º Prompt**ï¼šå°†å·¥ä½œè®°å½•å¡«å……åˆ°æ¨¡æ¿ä¸­
6. **è°ƒç”¨ AI**ï¼šæ ¹æ® `ai_provider` é…ç½®é€‰æ‹©å¯¹åº”å®¢æˆ·ç«¯ï¼ˆcodex/coco/claudeï¼‰
7. **ä¿å­˜ç»“æœ**ï¼šå°† AI ç”Ÿæˆçš„æ€»ç»“ä¿å­˜ä¸º Markdown æ–‡ä»¶åˆ° `run/summaries/daily/`
8. **æ ‡è®°çŠ¶æ€**ï¼šåœ¨ DailyData ä¸­æ ‡è®° `summary_generated: true`
9. **å‘é€é€šçŸ¥**ï¼šé€šè¿‡ osascript æ˜¾ç¤ºç³»ç»Ÿé€šçŸ¥

#### AI æ”¶åˆ°çš„ Prompt æ ¼å¼

Prompt ä» `templates/summary_prompt.md` æ¨¡æ¿åŠ è½½ï¼Œæ¨¡æ¿åŒ…å«ï¼š

- æ—¥æœŸå’Œè®°å½•æ¡æ•°ä¿¡æ¯
- æ ¼å¼åŒ–çš„å·¥ä½œè®°å½•åˆ—è¡¨ï¼ˆå¸¦æ—¶é—´æˆ³ï¼‰
- è¯¦ç»†çš„è¾“å‡ºæ ¼å¼è¦æ±‚ï¼ˆä¸»è¦ä»»åŠ¡ã€å…³é”®è¿›å±•ã€é—®é¢˜ã€æ˜æ—¥è®¡åˆ’ï¼‰
- æ—¶é—´åˆ†æè¦æ±‚ï¼ˆä½¿ç”¨ Mermaid å›¾è¡¨å¯è§†åŒ–ï¼‰
- å·¥ä½œæ—¶é•¿ä¼°ç®—è§„åˆ™

**æ¨¡æ¿ç¤ºä¾‹ç»“æ„**ï¼š
```markdown
è¯·ä¸ºä»¥ä¸‹å·¥ä½œè®°å½•ç”Ÿæˆä¸€ä»½ç»“æ„åŒ–çš„å·¥ä½œæ€»ç»“ï¼ˆæ—¥æœŸï¼š{date}ï¼Œå…±{count}æ¡è®°å½•ï¼‰

å·¥ä½œè®°å½•ï¼ˆæ¯æ¡è®°å½•æ˜¯å¯¹å‰ä¸€ä¸ªæ—¶é—´çª—å£å·¥ä½œå†…å®¹çš„æ€»ç»“ï¼‰ï¼š

{formatted_entries}

è¯·æŒ‰ç…§ä»¥ä¸‹æ ¼å¼ç”Ÿæˆæ€»ç»“ï¼š
## ä¸»è¦å®Œæˆçš„ä»»åŠ¡
ï¼ˆåˆ—å‡ºå®Œæˆçš„ä¸»è¦å·¥ä½œï¼ŒæŒ‰é¡¹ç›®æˆ–æ¨¡å—åˆ†ç±»ï¼Œå¹¶ä¼°ç®—å·¥ä½œå®é™…è€—æ—¶ï¼‰

## å·¥ä½œæ—¶é—´åˆ†æ
ï¼ˆè¡¨æ ¼ + Mermaid é¥¼å›¾å±•ç¤ºæ—¶é—´åˆ†é…ï¼‰

## å…³é”®è¿›å±•
ï¼ˆçªå‡ºé‡è¦çš„è¿›å±•å’Œæˆæœï¼‰

## é‡åˆ°çš„é—®é¢˜
ï¼ˆå¦‚æœæœ‰è®°å½•åˆ°é—®é¢˜ï¼Œåˆ—å‡ºæ¥ï¼‰

## æ˜æ—¥è®¡åˆ’
ï¼ˆå¦‚æœè®°å½•ä¸­æœ‰æåŠï¼Œæ•´ç†å‡ºæ¥ï¼‰
```

å‘¨æ€»ç»“ä½¿ç”¨ `templates/weekly_summary_prompt.md`ï¼Œèšåˆ 7 å¤©çš„æ¯æ—¥æ€»ç»“ã€‚

#### AI æœŸæœ›è¾“å‡º

AI åº”è¯¥è¿”å›ç¬¦åˆæ¨¡æ¿æ ¼å¼çš„ Markdown æ–‡æœ¬ï¼ŒåŒ…æ‹¬ï¼š
- æŒ‰é¡¹ç›®/æ¨¡å—åˆ†ç±»çš„ä»»åŠ¡åˆ—è¡¨
- å·¥ä½œæ—¶é•¿ä¼°ç®—ï¼ˆä½¿ç”¨ 1 ä½å°æ•°çš„å°æ—¶æ•°ï¼‰
- å·¥ä½œæ—¶é—´åˆ†æï¼ˆè¡¨æ ¼ + Mermaid é¥¼å›¾ï¼‰
- é‡è¦è¿›å±•å’Œæˆæœ
- é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ
- æ˜æ—¥è®¡åˆ’ï¼ˆå¦‚æœ‰ï¼‰

**Mermaid å›¾è¡¨ç¤ºä¾‹**ï¼š
```markdown
## å·¥ä½œæ—¶é—´åˆ†æ

| é¡¹ç›®/æ¨¡å— | è€—æ—¶ |
|-----------|------|
| é¡¹ç›® A    | 3.5h |
| é¡¹ç›® B    | 2.0h |
| ä¼šè®®æ²Ÿé€š  | 1.5h |

```mermaid
pie
    title å·¥ä½œæ—¶é—´åˆ†é…
    "é¡¹ç›® A" : 3.5
    "é¡¹ç›® B" : 2.0
    "ä¼šè®®æ²Ÿé€š" : 1.5
` ``
```

å‘¨æ€»ç»“è¾“å‡ºæ ¼å¼ç±»ä¼¼ï¼Œä½†æ˜¯è·¨è¶Š 7 å¤©çš„æ›´é«˜å±‚æ¬¡æ€»ç»“ã€‚

### æ•°æ®ç»“æ„

```go
// WorkEntry è¡¨ç¤ºå•æ¬¡å·¥ä½œè®°å½•
type WorkEntry struct {
    Timestamp time.Time `json:"timestamp"` // è®°å½•æ—¶é—´
    Content   string    `json:"content"`   // å·¥ä½œå†…å®¹
}

// DailyData è¡¨ç¤ºä¸€å¤©çš„æ‰€æœ‰å·¥ä½œè®°å½•
type DailyData struct {
    Date             string      `json:"date"`               // æ ¼å¼: YYYY-MM-DD
    Entries          []WorkEntry `json:"entries"`            // å·¥ä½œè®°å½•åˆ—è¡¨
    SummaryGenerated bool        `json:"summary_generated"`  // æ˜¯å¦å·²ç”Ÿæˆæ€»ç»“
}

// SummaryMetadata æ€»ç»“çš„å…ƒæ•°æ®
type SummaryMetadata struct {
    GeneratedAt time.Time `json:"generated_at"` // ç”Ÿæˆæ—¶é—´
    Date        string    `json:"date"`         // æ€»ç»“å¯¹åº”çš„æ—¥æœŸ
    EntryCount  int       `json:"entry_count"`  // è®°å½•æ¡æ•°
}

// TaskConfig ä»»åŠ¡é…ç½®ï¼ˆå­˜å‚¨åœ¨ run/tasks.jsonï¼‰
type TaskConfig struct {
    ID              string                 `json:"id"`               // ä»»åŠ¡å”¯ä¸€æ ‡è¯†
    Name            string                 `json:"name"`             // ä»»åŠ¡æ˜¾ç¤ºåç§°
    Type            TaskType               `json:"type"`             // ä»»åŠ¡ç±»å‹ï¼š"interval", "daily", "once"
    Enabled         bool                   `json:"enabled"`          // æ˜¯å¦å¯ç”¨
    IntervalMinutes int                    `json:"interval_minutes"` // é—´éš”ä»»åŠ¡çš„åˆ†é’Ÿæ•°
    Time            string                 `json:"time"`             // æ¯æ—¥ä»»åŠ¡çš„æ—¶é—´ï¼ˆHH:MMï¼‰
    NextRun         time.Time              `json:"next_run"`         // ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
    LastRun         time.Time              `json:"last_run"`         // æœ€åæ‰§è¡Œæ—¶é—´
    LastSuccess     time.Time              `json:"last_success"`     // æœ€åæˆåŠŸæ—¶é—´
    LastError       string                 `json:"last_error"`       // æœ€åé”™è¯¯ä¿¡æ¯
    Data            map[string]interface{} `json:"data"`             // ä»»åŠ¡ç‰¹å®šæ•°æ®
}

// Config åº”ç”¨é…ç½®ï¼ˆå®Œæ•´å®šä¹‰è§ internal/models/models.goï¼‰
type Config struct {
    WorkDir              string // å·¥ä½œç›®å½•ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰
    DataDir              string // æ•°æ®ç›®å½•
    SummaryDir           string // æ€»ç»“ç›®å½•ï¼ˆåŒ…å« daily/ å’Œ weekly/ å­ç›®å½•ï¼‰
    HourlyInterval       int    // å°æ—¶é—´éš”
    MinuteInterval       int    // åˆ†é’Ÿé—´éš”ï¼ˆä¼˜å…ˆçº§æ›´é«˜ï¼‰
    SummaryTime          string // ç”Ÿæˆæ¯æ—¥æ€»ç»“çš„æ—¶é—´
    AIProvider           string // AI æä¾›å•†ï¼š"codex"ã€"coco" æˆ– "claude"
    CodexPath            string // Codex CLI è·¯å¾„
    CocoPath             string // Coco CLI è·¯å¾„
    ClaudeCodePath       string // Claude Code CLI è·¯å¾„
    DialogTimeout        int    // å¯¹è¯æ¡†è¶…æ—¶ï¼ˆç§’ï¼‰
    EnableLogging        bool   // æ˜¯å¦å¯ç”¨æ—¥å¿—
    LogFile              string // æ—¥å¿—æ–‡ä»¶è·¯å¾„
    MaxLogSizeMB         int    // æ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°ï¼ˆMBï¼‰
    EnableWeeklySummary  bool   // æ˜¯å¦å¯ç”¨å‘¨æ€»ç»“
    WeeklySummaryTime    string // ç”Ÿæˆå‘¨æ€»ç»“çš„æ—¶é—´
    WeeklySummaryDay     int    // ç”Ÿæˆå‘¨æ€»ç»“çš„æ˜ŸæœŸï¼ˆ1=å‘¨ä¸€ï¼Œ7=å‘¨æ—¥ï¼‰
}
```

### æ–‡ä»¶ç»„ç»‡

é¡¹ç›®é‡‡ç”¨æ ‡å‡† Go é¡¹ç›®ç»“æ„ï¼š

```
daily_summary/
â”œâ”€â”€ main.go                           # ç¨‹åºå…¥å£ï¼ŒCLI è·¯ç”±å’Œå‘½ä»¤å¤„ç†
â”œâ”€â”€ go.mod / go.sum                   # Go æ¨¡å—ä¾èµ–
â”‚
â”œâ”€â”€ config/                           # é…ç½®ç®¡ç†åŒ…
â”‚   â””â”€â”€ config.go                     # é…ç½®åŠ è½½ã€ä¿å­˜ã€è·¯å¾„è§£æ
â”‚
â”œâ”€â”€ internal/                         # å†…éƒ¨åŒ…ï¼ˆä¸å¯è¢«å¤–éƒ¨å¯¼å…¥ï¼‰
â”‚   â”œâ”€â”€ models/                       # æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ models.go                 # WorkEntry, DailyData, Config, TaskConfig ç­‰
â”‚   â”‚
â”‚   â”œâ”€â”€ scheduler/                    # å®šæ—¶ä»»åŠ¡è°ƒåº¦
â”‚   â”‚   â”œâ”€â”€ scheduler.go              # ç»Ÿä¸€è°ƒåº¦å™¨ï¼ˆæ¯åˆ†é’Ÿæ£€æŸ¥ä»»åŠ¡ï¼‰
â”‚   â”‚   â”œâ”€â”€ task.go                   # Task æ¥å£å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ registry.go               # ä»»åŠ¡æ³¨å†Œè¡¨ï¼ˆæ–‡ä»¶æŒä¹…åŒ–ï¼‰
â”‚   â”‚   â”œâ”€â”€ init.go                   # ä»»åŠ¡åˆå§‹åŒ–é€»è¾‘
â”‚   â”‚   â””â”€â”€ scheduler_test.go         # å•å…ƒæµ‹è¯•
â”‚   â”‚
â”‚   â”œâ”€â”€ tasks/                        # å…·ä½“ä»»åŠ¡å®ç°
â”‚   â”‚   â”œâ”€â”€ reminder.go               # å·¥ä½œè®°å½•æé†’ä»»åŠ¡
â”‚   â”‚   â”œâ”€â”€ summary.go                # æ¯æ—¥æ€»ç»“ç”Ÿæˆä»»åŠ¡
â”‚   â”‚   â”œâ”€â”€ weekly_summary.go         # æ¯å‘¨æ€»ç»“ç”Ÿæˆä»»åŠ¡
â”‚   â”‚   â””â”€â”€ log_rotate.go             # æ—¥å¿—è½®è½¬ä»»åŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ dialog/                       # å¯¹è¯æ¡†æ¥å£å’Œå®ç°
â”‚   â”‚   â”œâ”€â”€ dialog.go                 # Dialog æ¥å£å®šä¹‰
â”‚   â”‚   â””â”€â”€ osascript.go              # macOS osascript å®ç°
â”‚   â”‚
â”‚   â”œâ”€â”€ storage/                      # æ•°æ®å­˜å‚¨
â”‚   â”‚   â”œâ”€â”€ storage.go                # Storage æ¥å£å®šä¹‰
â”‚   â”‚   â””â”€â”€ json_storage.go           # JSON æ–‡ä»¶å­˜å‚¨å®ç°
â”‚   â”‚
â”‚   â”œâ”€â”€ summary/                      # AI æ€»ç»“ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ client.go                 # AIClient æ¥å£å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ codex.go                  # Codex å®¢æˆ·ç«¯å®ç°
â”‚   â”‚   â”œâ”€â”€ coco.go                   # Coco å®¢æˆ·ç«¯å®ç°
â”‚   â”‚   â”œâ”€â”€ claude.go                 # Claude Code å®¢æˆ·ç«¯å®ç°
â”‚   â”‚   â”œâ”€â”€ generator.go              # æ€»ç»“ç”Ÿæˆå™¨ï¼ˆæ¨¡æ¿åŠ è½½ã€æµç¨‹ç¼–æ’ï¼‰
â”‚   â”‚   â””â”€â”€ generator_test.go         # å•å…ƒæµ‹è¯•
â”‚   â”‚
â”‚   â””â”€â”€ cli/                          # CLI å‘½ä»¤å®ç°
â”‚       â”œâ”€â”€ cli.go                    # add, popup, list å‘½ä»¤ï¼Œè¿›ç¨‹é”
â”‚       â””â”€â”€ cli_test.go               # å•å…ƒæµ‹è¯•
â”‚
â”œâ”€â”€ templates/                        # Prompt æ¨¡æ¿
â”‚   â”œâ”€â”€ summary_prompt.md             # æ¯æ—¥æ€»ç»“ Prompt æ¨¡æ¿
â”‚   â””â”€â”€ weekly_summary_prompt.md      # æ¯å‘¨æ€»ç»“ Prompt æ¨¡æ¿
â”‚
â”œâ”€â”€ scripts/                          # å®‰è£…å’Œæµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ install.sh                    # å®‰è£…è„šæœ¬ï¼ˆç¼–è¯‘ã€é…ç½®ã€launchdï¼‰
â”‚   â”œâ”€â”€ uninstall.sh                  # å¸è½½è„šæœ¬
â”‚   â”œâ”€â”€ quick_test.sh                 # å¿«é€Ÿæµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ test_config.sh                # é…ç½®æµ‹è¯•
â”‚   â”œâ”€â”€ test_dialog.sh                # å¯¹è¯æ¡†æµ‹è¯•
â”‚   â””â”€â”€ test_minute_interval.sh       # åˆ†é’Ÿçº§è°ƒåº¦æµ‹è¯•
â”‚
â”œâ”€â”€ launchd/                          # macOS åå°æœåŠ¡
â”‚   â””â”€â”€ com.humg.daily_summary.plist  # launchd é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ docs/                             # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ QUICK_START.md                # å¿«é€Ÿå¼€å§‹æŒ‡å—
â”‚   â”œâ”€â”€ CONFIGURATION.md              # é…ç½®è¯¦è§£
â”‚   â””â”€â”€ MINUTE_SCHEDULING.md          # åˆ†é’Ÿçº§è°ƒåº¦è¯´æ˜
â”‚
â”œâ”€â”€ run/                              # è¿è¡Œæ—¶æ•°æ®ï¼ˆ.gitignoreï¼‰
â”‚   â”œâ”€â”€ data/                         # å·¥ä½œè®°å½• JSON æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ 2026-01-19.json
â”‚   â”‚   â””â”€â”€ 2026-01-20.json
â”‚   â”œâ”€â”€ summaries/                    # Markdown æ€»ç»“æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ daily/                    # æ¯æ—¥æ€»ç»“
â”‚   â”‚   â”‚   â”œâ”€â”€ 2026-01-19.md
â”‚   â”‚   â”‚   â””â”€â”€ 2026-01-20.md
â”‚   â”‚   â””â”€â”€ weekly/                   # æ¯å‘¨æ€»ç»“
â”‚   â”‚       â””â”€â”€ 2026-W04.md
â”‚   â”œâ”€â”€ logs/                         # æ—¥å¿—æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ app.log                   # åº”ç”¨æ—¥å¿—
â”‚   â”‚   â”œâ”€â”€ app.log.old               # è½®è½¬çš„æ—§æ—¥å¿—
â”‚   â”‚   â”œâ”€â”€ scheduler_check.log       # è°ƒåº¦å™¨æ£€æŸ¥æ—¥å¿—
â”‚   â”‚   â”œâ”€â”€ stdout.log                # æ ‡å‡†è¾“å‡ºï¼ˆlaunchdï¼‰
â”‚   â”‚   â””â”€â”€ stderr.log                # æ ‡å‡†é”™è¯¯ï¼ˆlaunchdï¼‰
â”‚   â”œâ”€â”€ tasks.json                    # ä»»åŠ¡æ³¨å†Œè¡¨ï¼ˆæŒä¹…åŒ–ï¼‰
â”‚   â””â”€â”€ daily_summary.lock            # è¿›ç¨‹é”æ–‡ä»¶
â”‚
â”œâ”€â”€ config.yaml                       # ç”¨æˆ·é…ç½®æ–‡ä»¶
â”œâ”€â”€ config.example.yaml               # é…ç½®ç¤ºä¾‹
â”œâ”€â”€ config.pomodoro.yaml              # ç•ªèŒ„é’Ÿé…ç½®ç¤ºä¾‹
â”‚
â”œâ”€â”€ CLAUDE.md                         # æœ¬æ–‡ä»¶ï¼šClaude Code å¼€å‘æŒ‡å—
â”œâ”€â”€ README.md                         # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â””â”€â”€ CHANGELOG.md                      # æ›´æ–°æ—¥å¿—
```

### é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶æ”¯æŒ YAML å’Œ JSON ä¸¤ç§æ ¼å¼ï¼ˆæ ¹æ®æ‰©å±•åè‡ªåŠ¨è¯†åˆ«ï¼‰ï¼š
- é»˜è®¤è·¯å¾„ï¼š`~/.config/daily_summary/config.yaml` æˆ–é¡¹ç›®æ ¹ç›®å½• `config.yaml`
- ç¤ºä¾‹æ–‡ä»¶ï¼š`config.example.yaml`

**å…³é”®é…ç½®é¡¹ï¼š**

**ç›®å½•é…ç½®ï¼š**
- `work_dir`ï¼šå·¥ä½œç›®å½•ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰ï¼Œç›¸å¯¹è·¯å¾„ä¼šåŸºäºæ­¤ç›®å½•è§£æ
- `data_dir`ï¼šå·¥ä½œè®°å½•å­˜å‚¨ç›®å½•ï¼ˆé»˜è®¤ `./run/data`ï¼‰
- `summary_dir`ï¼šæ€»ç»“æ–‡ä»¶å­˜å‚¨ç›®å½•ï¼ˆé»˜è®¤ `./run/summaries`ï¼‰

**æé†’é—´éš”ï¼š**
- `hourly_interval`ï¼šå°æ—¶çº§æé†’é—´éš”ï¼ˆé»˜è®¤ 1ï¼Œè¡¨ç¤ºæ¯å°æ—¶æé†’ä¸€æ¬¡ï¼‰
- `minute_interval`ï¼šåˆ†é’Ÿçº§æé†’é—´éš”ï¼ˆå¦‚æœè®¾ç½®åˆ™ä¼˜å…ˆä½¿ç”¨ï¼Œè¦†ç›– hourly_intervalï¼‰
  - ç¤ºä¾‹ï¼š30 è¡¨ç¤ºæ¯ 30 åˆ†é’Ÿæé†’ä¸€æ¬¡
  - é€‚ç”¨äºç•ªèŒ„å·¥ä½œæ³•ç­‰åœºæ™¯

**æ€»ç»“ç”Ÿæˆï¼š**
- `summary_time`ï¼šæ¯æ—¥ç”Ÿæˆæ€»ç»“çš„æ—¶é—´ï¼Œæ ¼å¼ "HH:MM"ï¼ˆé»˜è®¤ "00:00"ï¼‰
- `ai_provider`ï¼šAI æä¾›å•†ï¼Œå¯é€‰ "codex"ã€"coco" æˆ– "claude"ï¼ˆé»˜è®¤ "codex"ï¼‰
- `codex_path`ï¼šCodex CLI è·¯å¾„ï¼ˆé»˜è®¤ "codex"ï¼‰
- `coco_path`ï¼šCoco CLI è·¯å¾„ï¼ˆé»˜è®¤ "coco"ï¼‰
- `claude_code_path`ï¼šClaude Code CLI è·¯å¾„ï¼ˆé»˜è®¤ "claude-code"ï¼‰

**å‘¨æ€»ç»“é…ç½®ï¼ˆå¯é€‰ï¼‰ï¼š**
- `enable_weekly_summary`ï¼šæ˜¯å¦å¯ç”¨å‘¨æ€»ç»“ï¼ˆé»˜è®¤ falseï¼‰
- `weekly_summary_time`ï¼šæ¯å‘¨ç”Ÿæˆæ€»ç»“çš„æ—¶é—´ï¼Œæ ¼å¼ "HH:MM"ï¼ˆé»˜è®¤ "11:00"ï¼‰
- `weekly_summary_day`ï¼šæ¯å‘¨ç”Ÿæˆæ€»ç»“çš„æ˜ŸæœŸå‡ ï¼ˆ1=å‘¨ä¸€ï¼Œ7=å‘¨æ—¥ï¼Œé»˜è®¤ 1ï¼‰

**å…¶ä»–é…ç½®ï¼š**
- `dialog_timeout`ï¼šå¯¹è¯æ¡†è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼Œé»˜è®¤ 300ï¼‰
- `enable_logging`ï¼šæ˜¯å¦å¯ç”¨æ—¥å¿—è®°å½•ï¼ˆé»˜è®¤ trueï¼‰
- `log_file`ï¼šæ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤ `./run/logs/app.log`ï¼‰
- `max_log_size_mb`ï¼šæ—¥å¿—æ–‡ä»¶æœ€å¤§å¤§å°ï¼ˆMBï¼‰ï¼Œè¶…è¿‡åè‡ªåŠ¨è½®è½¬ï¼ˆ0 è¡¨ç¤ºä¸é™åˆ¶ï¼‰

**è¯´æ˜**ï¼š
- `summary_dir` åŒ…å«ä¸¤ä¸ªå­ç›®å½•ï¼š`daily/`ï¼ˆæ¯æ—¥æ€»ç»“ï¼‰å’Œ `weekly/`ï¼ˆæ¯å‘¨æ€»ç»“ï¼‰
- å‘¨æ€»ç»“ä¼šè‡ªåŠ¨èšåˆè¯¥å‘¨çš„æ‰€æœ‰æ¯æ—¥æ€»ç»“

é…ç½®æ–‡ä»¶ä¼šåœ¨ç¨‹åºå¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä½¿ç”¨é»˜è®¤é…ç½®ã€‚

## CLI Usage

ç¨‹åºæ”¯æŒä»¥ä¸‹å‘½ä»¤ï¼š

### 1. serveï¼ˆé»˜è®¤å‘½ä»¤ï¼‰

å¯åŠ¨åå°æœåŠ¡ï¼Œè¿è¡Œå®šæ—¶æé†’å’Œæ€»ç»“ç”Ÿæˆä»»åŠ¡ã€‚

```bash
daily_summary serve
# æˆ–ç›´æ¥è¿è¡Œ
daily_summary
```

**ç‰¹æ€§**ï¼š
- æ£€æŸ¥å¹¶è·å–è¿›ç¨‹é”ï¼Œé˜²æ­¢é‡å¤å¯åŠ¨
- åŠ è½½é…ç½®æ–‡ä»¶
- è®¾ç½®æ—¥å¿—è®°å½•
- åˆå§‹åŒ–æ‰€æœ‰ç»„ä»¶ï¼ˆå¯¹è¯æ¡†ã€å­˜å‚¨ã€AI å®¢æˆ·ç«¯ã€ç”Ÿæˆå™¨ã€è°ƒåº¦å™¨ï¼‰
- ç›‘å¬ç³»ç»Ÿä¿¡å·ä¼˜é›…é€€å‡ºï¼ˆCtrl+Cï¼‰

### 2. add - æ‰‹åŠ¨æ·»åŠ å·¥ä½œè®°å½•

ç«‹å³æ·»åŠ ä¸€æ¡å·¥ä½œè®°å½•ï¼Œæ— éœ€ç­‰å¾…å®šæ—¶å¼¹çª—ã€‚

```bash
daily_summary add "å®Œæˆéœ€æ±‚æ–‡æ¡£å®¡æŸ¥"
daily_summary add "ä¿®å¤ç™»å½•é¡µé¢çš„ bug"
```

**ç‰¹æ€§**ï¼š
- è®°å½•å½“å‰æ—¶é—´æˆ³
- ä¿å­˜åˆ°å½“æ—¥ JSON æ–‡ä»¶
- å‘é€é‡ç½®ä¿¡å·ï¼Œè‡ªåŠ¨é¡ºå»¶ä¸‹æ¬¡æé†’æ—¶é—´
- æ‰“å°ç¡®è®¤ä¿¡æ¯

### 3. list - æŸ¥çœ‹ä»Šæ—¥è®°å½•

æ˜¾ç¤ºä»Šå¤©å·²è®°å½•çš„æ‰€æœ‰å·¥ä½œå†…å®¹ã€‚

```bash
daily_summary list
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
ğŸ“ ä»Šæ—¥å·¥ä½œè®°å½• (2026-01-20)ï¼š

  â€¢ 09:30 - å®Œæˆéœ€æ±‚æ–‡æ¡£å®¡æŸ¥
  â€¢ 11:00 - å‚åŠ æŠ€æœ¯è¯„å®¡ä¼šè®®
  â€¢ 14:00 - ä¿®å¤ç™»å½•é¡µé¢çš„ bug

å…± 3 æ¡è®°å½•
```

### 4. popup - æ˜¾ç¤ºè¾“å…¥å¯¹è¯æ¡†

æ‰‹åŠ¨è§¦å‘è¾“å…¥å¯¹è¯æ¡†ï¼Œç±»ä¼¼äºå®šæ—¶æé†’çš„å¼¹çª—ã€‚

```bash
daily_summary popup
```

**ç‰¹æ€§**ï¼š
- æ˜¾ç¤º macOS åŸç”Ÿè¾“å…¥å¯¹è¯æ¡†
- æ˜¾ç¤ºå½“æ—¥å·²æœ‰è®°å½•ä½œä¸ºä¸Šä¸‹æ–‡
- ç”¨æˆ·è¾“å…¥åè‡ªåŠ¨ä¿å­˜å·¥ä½œè®°å½•
- è‡ªåŠ¨æ›´æ–°ä¸‹æ¬¡æé†’æ—¶é—´

### 5. summary - æ‰‹åŠ¨ç”Ÿæˆæ¯æ—¥æ€»ç»“

æ‰‹åŠ¨è§¦å‘æŒ‡å®šæ—¥æœŸçš„å·¥ä½œæ€»ç»“ç”Ÿæˆã€‚

```bash
# ç”Ÿæˆä»Šå¤©çš„æ€»ç»“
daily_summary summary

# ç”ŸæˆæŒ‡å®šæ—¥æœŸçš„æ€»ç»“
daily_summary summary --date 2026-01-19
```

**ç‰¹æ€§**ï¼š
- æ”¯æŒ `--date` å‚æ•°æŒ‡å®šæ—¥æœŸï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼‰
- æ£€æŸ¥æ˜¯å¦æœ‰å·¥ä½œè®°å½•
- ä»æ¨¡æ¿åŠ è½½ Prompt
- è°ƒç”¨ AI ç”Ÿæˆæ€»ç»“
- ä¿å­˜ Markdown æ–‡ä»¶åˆ° `summary_dir/daily/`
- æ ‡è®°æ€»ç»“ç”ŸæˆçŠ¶æ€
- æ‰“å°æ–‡ä»¶è·¯å¾„

### 6. weekly - æ‰‹åŠ¨ç”Ÿæˆæ¯å‘¨æ€»ç»“

æ‰‹åŠ¨è§¦å‘æŒ‡å®šå‘¨çš„å·¥ä½œæ€»ç»“ç”Ÿæˆã€‚

```bash
# ç”Ÿæˆæœ¬å‘¨çš„æ€»ç»“
daily_summary weekly

# ç”ŸæˆæŒ‡å®šæ—¥æœŸæ‰€åœ¨å‘¨çš„æ€»ç»“
daily_summary weekly --date 2026-01-20
```

**ç‰¹æ€§**ï¼š
- æ”¯æŒ `--date` å‚æ•°ï¼ˆæŒ‡å®šè¯¥å‘¨å†…ä»»æ„æ—¥æœŸï¼‰
- è‡ªåŠ¨èšåˆè¯¥å‘¨çš„æ‰€æœ‰æ¯æ—¥æ€»ç»“
- ä» `templates/weekly_summary_prompt.md` åŠ è½½æ¨¡æ¿
- è°ƒç”¨ AI ç”Ÿæˆå‘¨æ€»ç»“
- ä¿å­˜åˆ° `summary_dir/weekly/YYYY-Wnn.md`ï¼ˆISO å‘¨ç¼–å·ï¼‰

### 7. help - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯

```bash
daily_summary help
# æˆ–
daily_summary --help
```

### å…¨å±€é€‰é¡¹

**--config**ï¼šæŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„

```bash
daily_summary --config ~/my-config.yaml serve
daily_summary --config ./custom.yaml add "å®Œæˆæµ‹è¯•"
```

## Deployment

### macOS launchd é›†æˆ

é¡¹ç›®æä¾›è„šæœ¬å®ç° launchd åå°æœåŠ¡ï¼š

**å®‰è£…è„šæœ¬**ï¼š`scripts/install.sh`
- ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶
- åˆ›å»ºè¿è¡Œç›®å½•ï¼ˆrun/data, run/summaries, run/logsï¼‰
- å¤åˆ¶é…ç½®æ–‡ä»¶
- å®‰è£… launchd plist æ–‡ä»¶
- å¯åŠ¨æœåŠ¡

**å¸è½½è„šæœ¬**ï¼š`scripts/uninstall.sh`
- åœæ­¢å¹¶å¸è½½ launchd æœåŠ¡
- åˆ é™¤ plist æ–‡ä»¶
- ä¿ç•™æ•°æ®å’Œé…ç½®

**plist é…ç½®**ï¼š`launchd/com.humg.daily_summary.plist`
- WorkingDirectoryï¼šé¡¹ç›®æ ¹ç›®å½•
- StandardOutPathï¼š`run/logs/stdout.log`
- StandardErrorPathï¼š`run/logs/stderr.log`
- RunAtLoadï¼šç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œ
- KeepAliveï¼šå´©æºƒåè‡ªåŠ¨é‡å¯ 